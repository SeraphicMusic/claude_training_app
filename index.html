<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tr칛ningsdashboard</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(to bottom right, #eff6ff, #e0e7ff);
            min-height: 100vh;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem 1rem;
        }
        .card {
            background: white;
            border-radius: 1rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }
        .header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 1rem;
        }
        .header-left {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }
        .header-right {
            display: flex;
            gap: 0.5rem;
        }
        h1 {
            font-size: 1.875rem;
            font-weight: bold;
            color: #111827;
        }
        h2 {
            font-size: 1.25rem;
            font-weight: bold;
            color: #111827;
            margin-bottom: 1rem;
        }
        .file-name {
            font-size: 0.875rem;
            color: #6b7280;
            margin-top: 0.25rem;
        }
        .btn {
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            font-weight: 500;
            border: none;
            cursor: pointer;
            transition: all 0.2s;
        }
        .btn-primary {
            background: #2563eb;
            color: white;
        }
        .btn-primary:hover {
            background: #1d4ed8;
        }
        .btn-secondary {
            background: #f3f4f6;
            color: #374151;
        }
        .btn-secondary:hover {
            background: #e5e7eb;
        }
        .btn-icon {
            padding: 0.5rem;
            background: transparent;
            border: none;
            cursor: pointer;
            border-radius: 0.5rem;
            transition: background 0.2s;
        }
        .btn-icon:hover {
            background: #f3f4f6;
        }
        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        .tabs {
            display: flex;
            gap: 0.5rem;
        }
        .tab {
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            font-weight: 500;
            border: none;
            cursor: pointer;
            transition: all 0.2s;
        }
        .tab.active {
            background: #2563eb;
            color: white;
        }
        .tab.inactive {
            background: #f3f4f6;
            color: #374151;
        }
        .tab.inactive:hover {
            background: #e5e7eb;
        }
        .day-nav {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        .day-nav-center {
            text-align: center;
        }
        .day-title {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            justify-content: center;
            margin-bottom: 0.25rem;
        }
        .today-badge {
            font-size: 0.875rem;
            color: #2563eb;
            font-weight: 500;
        }
        .badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.875rem;
            font-weight: 500;
        }
        .badge-green {
            background: #dcfce7;
            color: #166534;
        }
        .badge-blue {
            background: #dbeafe;
            color: #1e40af;
        }
        .grid {
            display: grid;
            gap: 1rem;
        }
        @media (min-width: 768px) {
            .grid-2 {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        .exercise-card {
            background: white;
            border: 1px solid #e5e7eb;
            border-radius: 0.5rem;
            padding: 1rem;
            box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            transition: box-shadow 0.2s;
        }
        .exercise-card:hover {
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        .exercise-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
        }
        .exercise-info {
            flex: 1;
        }
        .exercise-name {
            font-size: 1.125rem;
            font-weight: 600;
            color: #111827;
        }
        .exercise-details {
            margin-top: 0.5rem;
            display: flex;
            gap: 1rem;
            font-size: 0.875rem;
            color: #6b7280;
        }
        .exercise-detail {
            font-weight: 500;
        }
        .exercise-detail-value {
            color: #111827;
        }
        .text-center {
            text-align: center;
        }
        .text-blue {
            color: #2563eb;
        }
        .text-gray {
            color: #6b7280;
        }
        .text-red {
            color: #dc2626;
        }
        .mb-1 { margin-bottom: 0.25rem; }
        .mb-2 { margin-bottom: 0.5rem; }
        .mb-4 { margin-bottom: 1rem; }
        .mb-6 { margin-bottom: 1.5rem; }
        .mb-8 { margin-bottom: 2rem; }
        .mt-1 { margin-top: 0.25rem; }
        .mt-2 { margin-top: 0.5rem; }
        .upload-area {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            width: 100%;
            height: 12rem;
            border: 2px dashed #d1d5db;
            border-radius: 0.75rem;
            cursor: pointer;
            transition: all 0.2s;
        }
        .upload-area:hover {
            border-color: #2563eb;
            background: #eff6ff;
        }
        .upload-icon {
            margin-bottom: 1rem;
            color: #9ca3af;
        }
        .upload-text {
            margin-bottom: 0.5rem;
            font-size: 0.875rem;
            color: #6b7280;
        }
        .upload-subtext {
            font-size: 0.75rem;
            color: #6b7280;
        }
        input[type="file"] {
            display: none;
        }
        .input {
            width: 100%;
            padding: 0.5rem 1rem;
            border: 1px solid #d1d5db;
            border-radius: 0.5rem;
            font-size: 1rem;
        }
        .input:focus {
            outline: none;
            border-color: #2563eb;
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }
        .label {
            display: block;
            font-size: 0.875rem;
            font-weight: 500;
            color: #374151;
            margin-bottom: 0.5rem;
        }
        .space-y-4 > * + * {
            margin-top: 1rem;
        }
        .info-box {
            background: #eff6ff;
            border: 1px solid #bfdbfe;
            border-radius: 0.5rem;
            padding: 1rem;
        }
        .info-title {
            font-weight: 600;
            color: #1e3a8a;
            margin-bottom: 0.5rem;
        }
        .info-list {
            font-size: 0.875rem;
            color: #1e40af;
            list-style: decimal;
            padding-left: 1.25rem;
        }
        .info-list li {
            margin-top: 0.25rem;
        }
        .info-link {
            text-decoration: underline;
        }
        .error-box {
            background: #fef2f2;
            border: 1px solid #fecaca;
            border-radius: 0.5rem;
            padding: 1rem;
        }
        .error-text {
            color: #991b1b;
        }
        .empty-state {
            background: white;
            border-radius: 1rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            padding: 3rem;
            text-align: center;
        }
        .empty-text {
            color: #6b7280;
            font-size: 1.125rem;
        }
        .day-card {
            background: white;
            border-radius: 1rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            padding: 1.5rem;
        }
        .day-card.today {
            box-shadow: 0 0 0 2px #2563eb;
        }
        .day-card-header {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }
        .day-card-title {
            font-size: 1.5rem;
            font-weight: bold;
            color: #111827;
        }
        .rest-day {
            color: #6b7280;
            font-style: italic;
        }
        .daily-section {
            background: #f0fdf4;
            border: 2px solid #bbf7d0;
            border-radius: 1rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            padding: 1.5rem;
        }
        .flex-between {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .flex-gap {
            display: flex;
            gap: 0.5rem;
        }
        .animate-spin {
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        .max-w-2xl {
            max-width: 42rem;
        }
        .mx-auto {
            margin-left: auto;
            margin-right: auto;
        }
        .w-full {
            width: 100%;
        }
        .btn-full {
            width: 100%;
        }
        .text-4xl {
            font-size: 2.25rem;
        }
        .font-bold {
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        const Calendar = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                <line x1="16" y1="2" x2="16" y2="6"></line>
                <line x1="8" y1="2" x2="8" y2="6"></line>
                <line x1="3" y1="10" x2="21" y2="10"></line>
            </svg>
        );

        const Dumbbell = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <path d="M14.4 14.4L9.6 9.6"></path>
                <path d="M18.657 21.485l-2.829-2.828a4 4 0 0 1 0-5.657l2.829-2.828a4 4 0 1 1 5.657 5.657l-2.829 2.828a4 4 0 0 1-5.657 0z"></path>
                <path d="M5.343 2.515l2.828 2.828a4 4 0 0 1 0 5.657L5.343 13.828a4 4 0 1 1-5.657-5.657l2.828-2.828a4 4 0 0 1 5.657 0z"></path>
            </svg>
        );

        const Upload = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                <polyline points="17 8 12 3 7 8"></polyline>
                <line x1="12" y1="3" x2="12" y2="15"></line>
            </svg>
        );

        const ChevronLeft = ({ size = 24 }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <polyline points="15 18 9 12 15 6"></polyline>
            </svg>
        );

        const ChevronRight = ({ size = 24 }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <polyline points="9 18 15 12 9 6"></polyline>
            </svg>
        );

        const RefreshCw = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <polyline points="23 4 23 10 17 10"></polyline>
                <polyline points="1 20 1 14 7 14"></polyline>
                <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path>
            </svg>
        );

        const LogOut = ({ size = 24 }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                <polyline points="16 17 21 12 16 7"></polyline>
                <line x1="21" y1="12" x2="9" y2="12"></line>
            </svg>
        );

        const Settings = ({ size = 24 }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <circle cx="12" cy="12" r="3"></circle>
                <path d="M12 1v6m0 6v6m5.2-14.8l-4.2 4.2m0 5.2l4.2 4.2M23 12h-6m-6 0H1m14.8-5.2l-4.2 4.2m0 5.2l-4.2 4.2"></path>
            </svg>
        );

        const TrainingDashboard = () => {
            const [workoutData, setWorkoutData] = useState(null);
            const [selectedDay, setSelectedDay] = useState(new Date().getDay());
            const [view, setView] = useState('today');
            const [isSignedIn, setIsSignedIn] = useState(false);
            const [selectedFileId, setSelectedFileId] = useState(null);
            const [selectedFileName, setSelectedFileName] = useState('');
            const [showSettings, setShowSettings] = useState(false);
            const [clientId, setClientId] = useState('');
            const [apiKey, setApiKey] = useState('');
            const [loading, setLoading] = useState(false);
            const [error, setError] = useState('');

            const daysOfWeek = ['S칬ndag', 'M친ndag', 'Tisdag', 'Onsdag', 'Torsdag', 'Fredag', 'L칬rdag'];
            const dayMapping = {
                'm친ndag': 1, 'm친n': 1,
                'tisdag': 2, 'tis': 2,
                'onsdag': 3, 'ons': 3,
                'torsdag': 4, 'tor': 4,
                'fredag': 5, 'fre': 5,
                'l칬rdag': 6, 'l칬r': 6,
                's칬ndag': 0, 's칬n': 0
            };

            useEffect(() => {
                const savedClientId = localStorage.getItem('googleClientId');
                const savedApiKey = localStorage.getItem('googleApiKey');
                const savedFileId = localStorage.getItem('selectedFileId');
                const savedFileName = localStorage.getItem('selectedFileName');
                
                if (savedClientId) setClientId(savedClientId);
                if (savedApiKey) setApiKey(savedApiKey);
                if (savedFileId) setSelectedFileId(savedFileId);
                if (savedFileName) setSelectedFileName(savedFileName);
            }, []);

            useEffect(() => {
                if (!clientId || !apiKey) return;

                const script = document.createElement('script');
                script.src = 'https://accounts.google.com/gsi/client';
                script.async = true;
                script.defer = true;
                document.body.appendChild(script);

                const script2 = document.createElement('script');
                script2.src = 'https://apis.google.com/js/api.js';
                script2.async = true;
                script2.defer = true;
                script2.onload = () => {
                    window.gapi.load('picker', () => {});
                };
                document.body.appendChild(script2);

                return () => {
                    if (document.body.contains(script)) document.body.removeChild(script);
                    if (document.body.contains(script2)) document.body.removeChild(script2);
                };
            }, [clientId, apiKey]);

            const saveSettings = () => {
                localStorage.setItem('googleClientId', clientId);
                localStorage.setItem('googleApiKey', apiKey);
                setShowSettings(false);
                setError('');
            };

            const handleGoogleSignIn = (response) => {
                if (response.access_token) {
                    setIsSignedIn(true);
                    setError('');
                    
                    if (selectedFileId) {
                        loadFileFromDrive(selectedFileId, response.access_token);
                    }
                }
            };

            const signIn = () => {
                if (!clientId || !apiKey) {
                    setError('V칛nligen l칛gg till dina API-nycklar i inst칛llningarna f칬rst');
                    setShowSettings(true);
                    return;
                }

                const client = window.google.accounts.oauth2.initTokenClient({
                    client_id: clientId,
                    scope: 'https://www.googleapis.com/auth/drive.readonly',
                    callback: handleGoogleSignIn,
                });
                client.requestAccessToken();
            };

            const signOut = () => {
                setIsSignedIn(false);
                setWorkoutData(null);
            };

            const openPicker = () => {
                if (!clientId || !apiKey) {
                    setError('API-nycklar saknas');
                    return;
                }

                const client = window.google.accounts.oauth2.initTokenClient({
                    client_id: clientId,
                    scope: 'https://www.googleapis.com/auth/drive.readonly',
                    callback: (response) => {
                        if (response.access_token) {
                            const picker = new window.google.picker.PickerBuilder()
                                .addView(window.google.picker.ViewId.DOCS)
                                .setOAuthToken(response.access_token)
                                .setDeveloperKey(apiKey)
                                .setCallback((data) => {
                                    if (data.action === window.google.picker.Action.PICKED) {
                                        const file = data.docs[0];
                                        setSelectedFileId(file.id);
                                        setSelectedFileName(file.name);
                                        localStorage.setItem('selectedFileId', file.id);
                                        localStorage.setItem('selectedFileName', file.name);
                                        loadFileFromDrive(file.id, response.access_token);
                                    }
                                })
                                .build();
                            picker.setVisible(true);
                        }
                    },
                });
                client.requestAccessToken();
            };

            const loadFileFromDrive = async (fileId, accessToken) => {
                setLoading(true);
                setError('');
                
                try {
                    const response = await fetch(
                        `https://www.googleapis.com/drive/v3/files/${fileId}?alt=media`,
                        {
                            headers: {
                                Authorization: `Bearer ${accessToken}`,
                            },
                        }
                    );

                    if (!response.ok) {
                        throw new Error('Kunde inte ladda filen fr친n Drive');
                    }

                    const blob = await response.blob();
                    const arrayBuffer = await blob.arrayBuffer();
                    const workbook = XLSX.read(arrayBuffer, { type: 'array' });
                    
                    const data = {};
                    
                    workbook.SheetNames.forEach(sheetName => {
                        const ws = workbook.Sheets[sheetName];
                        const jsonData = XLSX.utils.sheet_to_json(ws, { header: 1 });
                        
                        const filteredData = jsonData.filter(row => 
                            row.some(cell => cell !== undefined && cell !== null && cell !== '')
                        );
                        
                        const exercises = [];
                        let headers = [];
                        
                        filteredData.forEach((row, index) => {
                            if (index === 0) {
                                headers = row;
                            } else if (row.length > 0 && row[0]) {
                                const exercise = {};
                                headers.forEach((header, i) => {
                                    if (header && row[i] !== undefined && row[i] !== null && row[i] !== '') {
                                        exercise[header.toString().toLowerCase()] = row[i];
                                    }
                                });
                                if (Object.keys(exercise).length > 0) {
                                    exercises.push(exercise);
                                }
                            }
                        });
                        
                        const lowerSheetName = sheetName.toLowerCase().trim();
                        if (lowerSheetName.includes('varje dag') || lowerSheetName === 'daglig') {
                            data['daily'] = exercises;
                        } else {
                            for (const [key, value] of Object.entries(dayMapping)) {
                                if (lowerSheetName.includes(key)) {
                                    data[value] = exercises;
                                    break;
                                }
                            }
                        }
                    });
                    
                    setWorkoutData(data);
                    setLoading(false);
                } catch (err) {
                    setError('Kunde inte ladda filen: ' + err.message);
                    setLoading(false);
                }
            };

            const refreshFromDrive = () => {
                if (!selectedFileId) return;
                
                const client = window.google.accounts.oauth2.initTokenClient({
                    client_id: clientId,
                    scope: 'https://www.googleapis.com/auth/drive.readonly',
                    callback: (response) => {
                        if (response.access_token) {
                            loadFileFromDrive(selectedFileId, response.access_token);
                        }
                    },
                });
                client.requestAccessToken();
            };

            const handleLocalFileUpload = (e) => {
                const file = e.target.files[0];
                if (!file) return;

                const reader = new FileReader();
                reader.onload = (evt) => {
                    const bstr = evt.target.result;
                    const wb = XLSX.read(bstr, { type: 'binary' });
                    
                    const data = {};
                    
                    wb.SheetNames.forEach(sheetName => {
                        const ws = wb.Sheets[sheetName];
                        const jsonData = XLSX.utils.sheet_to_json(ws, { header: 1 });
                        
                        const filteredData = jsonData.filter(row => 
                            row.some(cell => cell !== undefined && cell !== null && cell !== '')
                        );
                        
                        const exercises = [];
                        let headers = [];
                        
                        filteredData.forEach((row, index) => {
                            if (index === 0) {
                                headers = row;
                            } else if (row.length > 0 && row[0]) {
                                const exercise = {};
                                headers.forEach((header, i) => {
                                    if (header && row[i] !== undefined && row[i] !== null && row[i] !== '') {
                                        exercise[header.toString().toLowerCase()] = row[i];
                                    }
                                });
                                if (Object.keys(exercise).length > 0) {
                                    exercises.push(exercise);
                                }
                            }
                        });
                        
                        const lowerSheetName = sheetName.toLowerCase().trim();
                        if (lowerSheetName.includes('varje dag') || lowerSheetName === 'daglig') {
                            data['daily'] = exercises;
                        } else {
                            for (const [key, value] of Object.entries(dayMapping)) {
                                if (lowerSheetName.includes(key)) {
                                    data[value] = exercises;
                                    break;
                                }
                            }
                        }
                    });
                    
                    setWorkoutData(data);
                };
                reader.readAsBinaryString(file);
            };

            const renderExercise = (exercise, index) => {
                const exerciseName = exercise.칬vning || exercise.exercise || exercise.namn || Object.values(exercise)[0];
                const sets = exercise.sets || exercise.set || '';
                const reps = exercise.reps || exercise.rep || exercise.repetitioner || '';
                
                return (
                    <div key={index} className="exercise-card">
                        <div className="exercise-header">
                            <div className="exercise-info">
                                <h3 className="exercise-name">{exerciseName}</h3>
                                <div className="exercise-details">
                                    {sets && <span className="exercise-detail">Sets: <span className="exercise-detail-value">{sets}</span></span>}
                                    {reps && <span className="exercise-detail">Reps: <span className="exercise-detail-value">{reps}</span></span>}
                                </div>
                            </div>
                            <Dumbbell size={24} className="text-blue" />
                        </div>
                    </div>
                );
            };

            const getTodayWorkout = () => {
                if (!workoutData) return null;
                return workoutData[selectedDay] || [];
            };

            const getDailyWorkout = () => {
                if (!workoutData) return null;
                return workoutData['daily'] || [];
            };

            const changeDay = (direction) => {
                setSelectedDay((prev) => {
                    let newDay = prev + direction;
                    if (newDay > 6) newDay = 0;
                    if (newDay < 0) newDay = 6;
                    return newDay;
                });
            };

            if (showSettings) {
                return (
                    <div className="container">
                        <div className="max-w-2xl mx-auto">
                            <div className="card">
                                <h2 className="text-4xl font-bold mb-6">Google Drive API-inst칛llningar</h2>
                                
                                <div className="space-y-4 mb-6">
                                    <div>
                                        <label className="label">Client ID</label>
                                        <input
                                            type="text"
                                            value={clientId}
                                            onChange={(e) => setClientId(e.target.value)}
                                            className="input"
                                            placeholder="Din Google Client ID"
                                        />
                                    </div>
                                    
                                    <div>
                                        <label className="label">API Key</label>
                                        <input
                                            type="text"
                                            value={apiKey}
                                            onChange={(e) => setApiKey(e.target.value)}
                                            className="input"
                                            placeholder="Din Google API Key"
                                        />
                                    </div>
                                </div>

                                <div className="info-box mb-6">
                                    <h3 className="info-title">游닇 Hur f친r jag API-nycklar?</h3>
                                    <ol className="info-list">
                                        <li>G친 till <a href="https://console.cloud.google.com" target="_blank" rel="noopener noreferrer" className="info-link">Google Cloud Console</a></li>
                                        <li>Skapa ett nytt projekt</li>
                                        <li>Aktivera "Google Drive API" och "Google Picker API"</li>
                                        <li>Skapa credentials (OAuth 2.0 Client ID och API Key)</li>
                                        <li>Kopiera och klistra in h칛r</li>
                                    </ol>
                                </div>

                                <div className="flex-gap">
                                    <button onClick={saveSettings} className="btn btn-primary w-full">
                                        Spara
                                    </button>
                                    <button onClick={() => setShowSettings(false)} className="btn btn-secondary">
                                        Avbryt
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                );
            }

            if (!workoutData) {
                return (
                    <div className="container">
                        <div className="max-w-2xl mx-auto">
                            <div className="text-center mb-8">
                                <Dumbbell size={48} className="text-blue mx-auto mb-4" />
                                <h1 className="text-4xl font-bold mb-2">Tr칛ningsdashboard</h1>
                                <p className="text-gray">Anslut till Google Drive eller ladda upp fil</p>
                            </div>

                            {error && (
                                <div className="error-box mb-6">
                                    <p className="error-text">{error}</p>
                                </div>
                            )}
                            
                            <div className="card mb-4">
                                <h2 className="mb-4">
                                    <span className="badge badge-blue">Rekommenderas</span> Google Drive
                                </h2>
                                <p className="text-gray mb-4">
                                    Anslut till Google Drive f칬r automatisk synkning av din tr칛ningsfil
                                </p>
                                
                                {!isSignedIn ? (
                                    <button
                                        onClick={signIn}
                                        disabled={loading}
                                        className="btn btn-primary btn-full"
                                    >
                                        {loading ? 'Laddar...' : 'Anslut till Google Drive'}
                                    </button>
                                ) : (
                                    <button
                                        onClick={openPicker}
                                        disabled={loading}
                                        className="btn btn-primary btn-full"
                                    >
                                        V칛lj fil fr친n Drive
                                    </button>
                                )}

                                <button
                                    onClick={() => setShowSettings(true)}
                                    className="btn-full mt-2 text-center text-gray"
                                    style={{textDecoration: 'underline', background: 'none', border: 'none', cursor: 'pointer'}}
                                >
                                    API-inst칛llningar
                                </button>
                            </div>

                            <div className="text-center mb-6 text-gray">eller</div>

                            <div className="card">
                                <h2 className="mb-4">Lokal fil</h2>
                                <label className="upload-area">
                                    <div>
                                        <Upload size={48} className="upload-icon mx-auto" />
                                        <p className="upload-text">
                                            <span style={{fontWeight: 600}}>Klicka f칬r att ladda upp</span>
                                        </p>
                                        <p className="upload-subtext">Excel-fil (.xlsx, .xls)</p>
                                    </div>
                                    <input 
                                        type="file" 
                                        accept=".xlsx,.xls" 
                                        onChange={handleLocalFileUpload}
                                    />
                                </label>
                            </div>
                        </div>
                    </div>
                );
            }

            const todayWorkout = getTodayWorkout();
            const dailyWorkout = getDailyWorkout();

            return (
                <div className="container">
                    <div className="card">
                        <div className="header">
                            <div className="header-left">
                                <Dumbbell size={32} className="text-blue" />
                                <div>
                                    <h1>Tr칛ningsdashboard</h1>
                                    {selectedFileName && (
                                        <p className="file-name">游늯 {selectedFileName}</p>
                                    )}
                                </div>
                            </div>
                            <div className="header-right">
                                {selectedFileId && (
                                    <button
                                        onClick={refreshFromDrive}
                                        disabled={loading}
                                        className="btn-icon"
                                        title="Uppdatera fr친n Drive"
                                    >
                                        <RefreshCw size={20} className={loading ? 'animate-spin' : ''} />
                                    </button>
                                )}
                                <button
                                    onClick={() => setShowSettings(true)}
                                    className="btn-icon"
                                    title="Inst칛llningar"
                                >
                                    <Settings size={20} />
                                </button>
                                {isSignedIn && (
                                    <button
                                        onClick={signOut}
                                        className="btn-icon"
                                        title="Logga ut"
                                    >
                                        <LogOut size={20} />
                                    </button>
                                )}
                            </div>
                        </div>
                        
                        <div className="tabs">
                            <button
                                onClick={() => setView('today')}
                                className={`tab ${view === 'today' ? 'active' : 'inactive'}`}
                            >
                                Dagens Pass
                            </button>
                            <button
                                onClick={() => setView('week')}
                                className={`tab ${view === 'week' ? 'active' : 'inactive'}`}
                            >
                                Vecko칬versikt
                            </button>
                        </div>
                    </div>

                    {view === 'today' ? (
                        <>
                            <div className="card">
                                <div className="day-nav">
                                    <button onClick={() => changeDay(-1)} className="btn-icon">
                                        <ChevronLeft size={24} />
                                    </button>
                                    
                                    <div className="day-nav-center">
                                        <div className="day-title">
                                            <Calendar size={20} className="text-blue" />
                                            <h2 style={{marginBottom: 0}}>{daysOfWeek[selectedDay]}</h2>
                                        </div>
                                        {selectedDay === new Date().getDay() && (
                                            <span className="today-badge">Idag</span>
                                        )}
                                    </div>
                                    
                                    <button onClick={() => changeDay(1)} className="btn-icon">
                                        <ChevronRight size={24} />
                                    </button>
                                </div>
                            </div>

                            {dailyWorkout && dailyWorkout.length > 0 && (
                                <div className="mb-6">
                                    <h2 style={{display: 'flex', alignItems: 'center', gap: '0.5rem'}}>
                                        <span className="badge badge-green">Varje Dag</span>
                                    </h2>
                                    <div className="grid grid-2">
                                        {dailyWorkout.map((exercise, index) => renderExercise(exercise, index))}
                                    </div>
                                </div>
                            )}

                            <div>
                                <h2>Dagens Tr칛ningspass</h2>
                                {todayWorkout && todayWorkout.length > 0 ? (
                                    <div className="grid grid-2">
                                        {todayWorkout.map((exercise, index) => renderExercise(exercise, index))}
                                    </div>
                                ) : (
                                    <div className="empty-state">
                                        <p className="empty-text">Inget tr칛ningspass planerat f칬r {daysOfWeek[selectedDay].toLowerCase()}</p>
                                    </div>
                                )}
                            </div>
                        </>
                    ) : (
                        <div>
                            {dailyWorkout && dailyWorkout.length > 0 && (
                                <div className="daily-section mb-6">
                                    <h2 style={{display: 'flex', alignItems: 'center', gap: '0.5rem'}}>
                                        <span className="badge badge-green">Varje Dag</span>
                                    </h2>
                                    <div className="grid grid-2">
                                        {dailyWorkout.map((exercise, index) => renderExercise(exercise, index))}
                                    </div>
                                </div>
                            )}

                            {daysOfWeek.map((day, dayIndex) => {
                                const dayWorkout = workoutData[dayIndex] || [];
                                const isToday = dayIndex === new Date().getDay();
                                
                                return (
                                    <div key={dayIndex} className={`day-card mb-6 ${isToday ? 'today' : ''}`}>
                                        <h2 className="day-card-header">
                                            <span className="day-card-title">{day}</span>
                                            {isToday && (
                                                <span className="badge badge-blue">Idag</span>
                                            )}
                                        </h2>
                                        {dayWorkout.length > 0 ? (
                                            <div className="grid grid-2">
                                                {dayWorkout.map((exercise, index) => renderExercise(exercise, index))}
                                            </div>
                                        ) : (
                                            <p className="rest-day">Vildag</p>
                                        )}
                                    </div>
                                );
                            })}
                        </div>
                    )}
                </div>
            );
        };

        ReactDOM.render(<TrainingDashboard />, document.getElementById('root'));
    </script>
</body>
</html>
